This repository contains MATLAB code to implement a segmentation and classification-based approach for assembling an automated screening system for the analysis of calcium imaging.  

# Setup

- [Prerequisites](#Prerequisites)
- [Getting started](#getting-started)
    - [Installation](#installation)
    - [Projection](#projection)
    - [Multi-level Thresholding](#Multi-level-Thresholding)
    - [Feature Image Generation](#Feature-Image-Generation)
- [Any problems?](#any-problems)
- [Finally](#finally)
	
## Prerequisites

Make sure you have the following requirements:

- MATLAB (we used Version of 2022a.)
- Statistics and Machine Learning Toolbox

## Getting Started

Ensure that all required files are added to the MATLAB path and run the function `main.m`

### Installation

To load the calcium imaging video and the .zip file belong to video's ground truth data, run the function `install.m` to ensure that all required files are added to the MATLAB path. We use free softwares named as `ReadImageJROI.m` and `tiffread2.m` written by `Dylan Muir` and `Francois Nedelec` in this part for reading ImageJ binary ROI file format and converting .stk files to .tiff video frames, respectively. We use these video frames for creating the video data.

```matlab
install();
```
### Projection

To convert video to image, run the function `projection.m`

```matlab
projection();
```
### Multi level Thresholding

The segmentation step we will describe here is applied to the images generated by the projection methods to obtain ROIs that could be assigned to individual astrocytes. Multi-level thresholding is implemented to determine the boundaries of each astrocyte. Segmentation metrics including precision and recall are calculated using these boundaries and ground truths to evaluate compatibility of them.

```matlab
mlt();
calcmetrics();
```
### Feature Image Generation

In this part of repository, feature images are created for classification for assembling an automated screening system for the analysis of calcium imaging. Feature images are created from a segmented image obtained after applying MLT. 

```matlab
createfeatimg();
```

## Any problems?

If you have any trouble using this code, report any bugs, or want to request a feature please use the [GitHub issues](https://github.com/gizemdursun/automated-analysis-of-biomedical-signals-obtained-from-calcium-imaging/issues).

## Finally

This repository is an implementation of our paper. We use 33 (21 ALS & 12 CTRL) calcium imaging videos. All results are submitted.
